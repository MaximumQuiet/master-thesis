\subsection{Модуль распознавания лиц}

Данный модуль состоит из трех несвязных частей -- распознавания лиц
в видеопотоке, распознавания лиц со статичного изображения, детектирования лиц
со статичного фото.

\subsubsection{Детектирование лиц со статичного изображения}

Для разработки функции детектирования лиц использовался алгоритм, основанный на
методе Виолы-Джонса. Данный метод основывается на примитивах Хаара,
представляющих собой разбивку заданной прямоугольной области на наборы
разнотипных прямоугольных подобластей:

\addimghere{haar-cascade}{0.8}{примитивы Хаара}

Для того, чтобы найти лицо, нужно выделить его основные компоненты, такие как
нос, глаза, лоб, губы. Для этого существуют специальные шаблоны (примитивы)
Хаара:

\addimghere{haar-cascade-eyes}{0.8}{примитивы Хаара для: лба, носа, глаз, губ,
подбородка (слева направо)}

Для каждого из этих шаблонов, высчитывается разность между яркостью белой
и чёрной областей. Это значение сравнивается с эталоном и принимается решение
о том, найдено лицо на фото или нет. В этом заключается метод Виолы-Джонса,
который успешно используется в сфере компьютерного зрения.

\addimghere{viola-jones-example}{0.4}{пример использования шаблонов Хаара}

Библиотека распознавания OpenCV имеет свою имплементацию алгоритма
Виолы-Джонса, использование заключается в написании следующего кода:

\lstset{language=Python, basicstyle=\normalsize, numbers=left, breaklines=true,
frame=single, showstringspaces=false, columns=fullflexible} 
\begin{lstlisting}
import cv2 as cv

face_cascade = cv.CascadeClassifier('haarcascade.xml')
faces = face_cascade.detectMultiScale(#COLOR, 3, 5)
\end{lstlisting}

Создание класса \textit{CascadeClassifier} происходит на основе файла с шаблонами
(примитивами) в формате XML. Данный класс содержит функцию
\textit{detectMultiScale()}, которая выполняет предобработку изображения --
преобразует его в черно-белый цвет и выполняет базовую цветокоррекцию, что
позволяет увеличить эффективность детектирования. После предобработки функция
применяет метод Виолы-Джонса, и возвращает результат в виде массива
с координатами лица на изображении. 
